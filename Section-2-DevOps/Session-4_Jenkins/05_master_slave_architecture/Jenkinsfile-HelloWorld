pipeline {
    agent {
        label 'slave'
    }
    // Pipeline runs on any slave node with 'slave' label
    
    stages {
        stage('Hello from Slave') {
            steps {
                script {
                    echo "üéâ Hello World from Jenkins Slave!"
                    echo "Running on: ${env.NODE_NAME}"
                    echo "Workspace: ${env.WORKSPACE}"
                    echo "Build Number: ${env.BUILD_NUMBER}"
                    echo "Job Name: ${env.JOB_NAME}"
                }
            }
        }
        // First stage: Display basic information about the slave node
        
        stage('System Information') {
            steps {
                echo "Gathering system information from slave..."
                sh 'echo "=== HOSTNAME ==="'
                sh 'hostname'
                sh 'echo "=== USER ==="'
                sh 'whoami'
                sh 'echo "=== CURRENT DIRECTORY ==="'
                sh 'pwd'
                sh 'echo "=== DATE AND TIME ==="'
                sh 'date'
                sh 'echo "=== SYSTEM INFO ==="'
                sh 'uname -a'
            }
        }
        // Second stage: Show system details from the slave node
        
        stage('Simple Commands') {
            steps {
                echo "Executing simple commands on slave node..."
                sh 'echo "This command is running on the slave node!"'
                sh 'echo "=== DIRECTORY LISTING ==="'
                sh 'ls -la'
                sh 'echo "=== DISK USAGE ==="'
                sh 'df -h'
                sh 'echo "=== MEMORY USAGE ==="'
                sh 'free -m'
            }
        }
        // Third stage: Execute basic Linux commands on slave
        
        stage('Create Test File') {
            steps {
                echo "Creating test file on slave node..."
                sh '''
                echo "=== CREATING HELLO FILE ==="
                echo "Hello from Jenkins Slave Node!" > hello-slave.txt
                echo "Generated on: $(date)" >> hello-slave.txt
                echo "Hostname: $(hostname)" >> hello-slave.txt
                echo "User: $(whoami)" >> hello-slave.txt
                echo "Working Directory: $(pwd)" >> hello-slave.txt
                echo ""
                echo "=== FILE CONTENTS ==="
                cat hello-slave.txt
                echo ""
                echo "=== FILE CREATED SUCCESSFULLY ==="
                ls -la hello-slave.txt
                '''
            }
        }
        // Fourth stage: Create and display a test file on slave
        
        stage('Cleanup') {
            steps {
                echo "Cleaning up test files..."
                sh '''
                if [ -f hello-slave.txt ]; then
                    echo "Removing hello-slave.txt"
                    rm hello-slave.txt
                    echo "Cleanup completed"
                else
                    echo "No files to clean up"
                fi
                '''
            }
        }
        // Fifth stage: Clean up created files
    }
    
    post {
        success {
            script {
                echo "‚úÖ SUCCESS: Hello World pipeline completed successfully!"
                echo "Pipeline executed on slave node: ${env.NODE_NAME}"
                echo "Total build time: ${currentBuild.durationString}"
            }
        }
        // Success block: Displays success message with build details
        
        failure {
            script {
                echo "‚ùå FAILURE: Pipeline failed on slave node"
                echo "Failed on node: ${env.NODE_NAME}"
                echo "Check the console output for error details"
            }
        }
        // Failure block: Displays error message if pipeline fails
        
        always {
            echo "üèÅ Pipeline execution completed on ${env.NODE_NAME}"
            echo "This message always appears regardless of build result"
        }
        // Always block: Runs regardless of success or failure
    }
}
